project('luacheck', version: '1.1.0')

meson.override_dependency(meson.project_name(), declare_dependency(version: meson.project_version()))

lua_dep = dependency('lua', version: ['>= 5.1'])
dependency('lua-argparse', version: ['>= 0.6.0'])
dependency('luafilesystem', version: ['>= 1.6.3'])

foreach _var : ['install_cmod', 'install_lmod']
  _val = lua_dep.get_variable(_var.to_upper(), pkgconfig_define: ['prefix', ''])
  set_variable(_var, _val.startswith('/') ? _val.substring(1) : _val)
endforeach

install_data(
  'src/luacheck/builtin_standards/init.lua',
  'src/luacheck/builtin_standards/love.lua',
  'src/luacheck/builtin_standards/ngx.lua',
  'src/luacheck/builtin_standards/playdate.lua',
  'src/luacheck/cache.lua',
  'src/luacheck/check.lua',
  'src/luacheck/check_state.lua',
  'src/luacheck/config.lua',
  'src/luacheck/core_utils.lua',
  'src/luacheck/decoder.lua',
  'src/luacheck/expand_rockspec.lua',
  'src/luacheck/filter.lua',
  'src/luacheck/format.lua',
  'src/luacheck/fs.lua',
  'src/luacheck/globbing.lua',
  'src/luacheck/init.lua',
  'src/luacheck/lexer.lua',
  'src/luacheck/main.lua',
  'src/luacheck/multithreading.lua',
  'src/luacheck/options.lua',
  'src/luacheck/parser.lua',
  'src/luacheck/profiler.lua',
  'src/luacheck/runner.lua',
  'src/luacheck/serializer.lua',
  'src/luacheck/stages/detect_bad_whitespace.lua',
  'src/luacheck/stages/detect_compound_operators.lua',
  'src/luacheck/stages/detect_cyclomatic_complexity.lua',
  'src/luacheck/stages/detect_empty_blocks.lua',
  'src/luacheck/stages/detect_empty_statements.lua',
  'src/luacheck/stages/detect_globals.lua',
  'src/luacheck/stages/detect_reversed_fornum_loops.lua',
  'src/luacheck/stages/detect_unbalanced_assignments.lua',
  'src/luacheck/stages/detect_uninit_accesses.lua',
  'src/luacheck/stages/detect_unreachable_code.lua',
  'src/luacheck/stages/detect_unused_fields.lua',
  'src/luacheck/stages/detect_unused_locals.lua',
  'src/luacheck/stages/init.lua',
  'src/luacheck/stages/linearize.lua',
  'src/luacheck/stages/name_functions.lua',
  'src/luacheck/stages/parse.lua',
  'src/luacheck/stages/parse_inline_options.lua',
  'src/luacheck/stages/resolve_locals.lua',
  'src/luacheck/stages/unwrap_parens.lua',
  'src/luacheck/standards.lua',
  'src/luacheck/unicode.lua',
  'src/luacheck/unicode_printability_boundaries.lua',
  'src/luacheck/utils.lua',
  'src/luacheck/vendor/sha1/bit32_ops.lua',
  'src/luacheck/vendor/sha1/bit_ops.lua',
  'src/luacheck/vendor/sha1/common.lua',
  'src/luacheck/vendor/sha1/init.lua',
  'src/luacheck/vendor/sha1/lua53_ops.lua',
  'src/luacheck/vendor/sha1/pure_lua_ops.lua',
  'src/luacheck/version.lua',
  rename: [
    'luacheck/builtin_standards/init.lua',
    'luacheck/builtin_standards/love.lua',
    'luacheck/builtin_standards/ngx.lua',
    'luacheck/builtin_standards/playdate.lua',
    'luacheck/cache.lua',
    'luacheck/check.lua',
    'luacheck/check_state.lua',
    'luacheck/config.lua',
    'luacheck/core_utils.lua',
    'luacheck/decoder.lua',
    'luacheck/expand_rockspec.lua',
    'luacheck/filter.lua',
    'luacheck/format.lua',
    'luacheck/fs.lua',
    'luacheck/globbing.lua',
    'luacheck/init.lua',
    'luacheck/lexer.lua',
    'luacheck/main.lua',
    'luacheck/multithreading.lua',
    'luacheck/options.lua',
    'luacheck/parser.lua',
    'luacheck/profiler.lua',
    'luacheck/runner.lua',
    'luacheck/serializer.lua',
    'luacheck/stages/detect_bad_whitespace.lua',
    'luacheck/stages/detect_compound_operators.lua',
    'luacheck/stages/detect_cyclomatic_complexity.lua',
    'luacheck/stages/detect_empty_blocks.lua',
    'luacheck/stages/detect_empty_statements.lua',
    'luacheck/stages/detect_globals.lua',
    'luacheck/stages/detect_reversed_fornum_loops.lua',
    'luacheck/stages/detect_unbalanced_assignments.lua',
    'luacheck/stages/detect_uninit_accesses.lua',
    'luacheck/stages/detect_unreachable_code.lua',
    'luacheck/stages/detect_unused_fields.lua',
    'luacheck/stages/detect_unused_locals.lua',
    'luacheck/stages/init.lua',
    'luacheck/stages/linearize.lua',
    'luacheck/stages/name_functions.lua',
    'luacheck/stages/parse.lua',
    'luacheck/stages/parse_inline_options.lua',
    'luacheck/stages/resolve_locals.lua',
    'luacheck/stages/unwrap_parens.lua',
    'luacheck/standards.lua',
    'luacheck/unicode.lua',
    'luacheck/unicode_printability_boundaries.lua',
    'luacheck/utils.lua',
    'luacheck/vendor/sha1/bit32_ops.lua',
    'luacheck/vendor/sha1/bit_ops.lua',
    'luacheck/vendor/sha1/common.lua',
    'luacheck/vendor/sha1/init.lua',
    'luacheck/vendor/sha1/lua53_ops.lua',
    'luacheck/vendor/sha1/pure_lua_ops.lua',
    'luacheck/version.lua',
  ],
  install_dir: install_lmod,
  install_tag: 'runtime',
)
