KOBO_DIR = $(PLATFORM_DIR)/kobo
KOBO_PACKAGE_OTA = koreader-$(DIST)$(KODEDUG_SUFFIX)-$(VERSION).tar.xz

define UPDATE_PATH_EXCLUDES +=
$(filter-out tools/kobo%,$(wildcard tools/*))
endef

update: all
	# ensure that the binaries were built for ARM
	file --dereference $(INSTALL_DIR)/koreader/luajit | grep ARM
	# Kobo launching scripts
	$(SYMLINK) $(KOBO_DIR)/koreader.png $(INSTALL_DIR)/
	$(SYMLINK) $(KOBO_DIR)/*.sh $(INSTALL_DIR)/koreader/
	# Create packages.
	$(strip $(call mkupdate,--manifest-transform=/^koreader\.png$$/d $(KOBO_PACKAGE_OTA))) koreader.png

PHONY += update
